SELECT DNAME,
       MAX(CASE WHEN ORDERID = '1' THEN C ELSE '' END) +
       MAX(CASE WHEN ORDERID = '2' THEN C ELSE '' END) +
       MAX(CASE WHEN ORDERID = '3' THEN C ELSE '' END) +
       MAX(CASE WHEN ORDERID = '4' THEN C ELSE '' END) AS DNAME1
  FROM (SELECT DNAME,
               SUBSTRING(DNAME, ID, 1) AS C,
               ROW_NUMBER() OVER(PARTITION BY DNAME ORDER BY ID) AS ORDERID,
               DEPTNO,
               ID
          FROM DEPT_TEST
         CROSS JOIN T10
         WHERE ID <= LEN(DNAME)
           AND ISNUMERIC(SUBSTRING(DNAME, ID, 1)) = 1
       ) AS X
 GROUP BY DNAME
 ORDER BY MAX(DEPTNO)