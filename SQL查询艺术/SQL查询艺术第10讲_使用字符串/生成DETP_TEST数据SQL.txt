INSERT INTO DEPT_TEST(DEPTNO, DNAME)
SELECT ROW_NUMBER() OVER(ORDER BY DEPTNO) AS DEPTNO, DATA FROM (
SELECT ENAME AS DATA, DEPTNO
  FROM EMP
 WHERE DEPTNO = 10
 UNION ALL
SELECT ENAME + ',$' + CAST(SAL AS VARCHAR(50)) AS DATA, DEPTNO
  FROM EMP
 WHERE DEPTNO = 20
 UNION ALL
SELECT ENAME + CAST(DEPTNO AS VARCHAR(50)) AS DATA, DEPTNO
  FROM EMP
 WHERE DEPTNO = 30) AS X